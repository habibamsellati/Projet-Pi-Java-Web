{% extends 'base.html.front.twig' %}

{% block title %}Valider la commande - AfkArt{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .valider-container { max-width: 600px; margin: 0 auto; padding: 2rem 1.5rem; }
        .page-title { font-family: 'Cormorant Garamond', serif; font-size: 2rem; color: #8b5e4a; margin-bottom: 1.5rem; }
        .recap { background: #f8f6f3; border-radius: 12px; padding: 1.25rem; margin-bottom: 1.5rem; }
        .recap-title { font-weight: 600; margin-bottom: 0.75rem; }
        .recap-item { display: flex; justify-content: space-between; padding: 0.35rem 0; font-size: 0.95rem; }
        .recap-total { font-weight: 700; font-size: 1.25rem; color: #8b5e4a; margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid #ddd; }
        .form-card { background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 12px rgba(0,0,0,0.08); }
        .form-group { margin-bottom: 1.25rem; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 0.35rem; color: #3d2817; }
        .form-group input, .form-group select { width: 100%; padding: 0.6rem 0.75rem; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; }
        .btn-submit { display: block; width: 100%; padding: 0.85rem; background: #2d7a4f; color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer; margin-top: 1rem; }
        .btn-submit:hover { background: #236b42; }
        .back-link { display: inline-block; color: #8b5e4a; text-decoration: none; margin-bottom: 1rem; font-weight: 500; }
        .back-link:hover { text-decoration: underline; }
        .alert { padding: 12px 16px; border-radius: 8px; margin-bottom: 1rem; }
        .alert-error { background: #f8d7da; color: #721c24; }
        .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
    </style>
{% endblock %}

{% block body %}
<div class="valider-container">
    <a href="{{ path('app_panier_index') }}" class="back-link" title="Retour au panier">← Retour au panier</a>
    <h1 class="page-title">Valider la commande</h1>

    {% for message in app.flashes('error') %}
        <div class="alert alert-error" role="alert">{{ message }}</div>
    {% endfor %}

    <section class="recap" aria-labelledby="recap-title">
        <h2 id="recap-title" class="recap-title" style="margin: 0 0 0.75rem 0; font-size: 1rem;">Récapitulatif</h2>
        {% for article in articles %}
        <div class="recap-item">
            <span>{{ article.titre }}</span>
            <span>{% if article.prix is not null and article.prix != '' %}{{ article.prix }} DT{% else %}—{% endif %}</span>
        </div>
        {% endfor %}
        <div class="recap-item recap-total">
            <span>Total de la commande</span>
            <span>{{ total|number_format(2, ',', ' ') }} DT</span>
        </div>
    </section>

    <section class="form-card" aria-labelledby="form-title">
        <h2 id="form-title" class="sr-only">Informations de livraison et paiement</h2>
        {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}
        <div class="form-group">
            {{ form_label(form.nom) }}
            {{ form_widget(form.nom) }}
            {{ form_errors(form.nom) }}
        </div>
        <div class="form-group">
            {{ form_label(form.prenom) }}
            {{ form_widget(form.prenom) }}
            {{ form_errors(form.prenom) }}
        </div>
        <div class="form-group">
            {{ form_label(form.numero) }}
            {{ form_widget(form.numero) }}
            {{ form_errors(form.numero) }}
        </div>
        <div class="form-group">
            {{ form_label(form.adresselivraison) }}
            {{ form_widget(form.adresselivraison) }}
            {{ form_errors(form.adresselivraison) }}
        </div>
        <div class="form-group">
            {{ form_label(form.modepaiement) }}
            {{ form_widget(form.modepaiement) }}
            {{ form_errors(form.modepaiement) }}
        </div>
        <button type="submit" class="btn-submit">Valider la commande</button>
        {{ form_end(form) }}
    </section>
</div>
{% endblock %}

{% extends 'base.html.front.twig' %}

{% block title %}Reinitialiser le mot de passe - AfkArt{% endblock %}

{% block body %}
<style>
  :root {
    --color-cream: #FAF7F2;
    --color-terracotta: #C4704B;
    --color-terracotta-dark: #A85D3B;
    --color-brown: #3D3229;
    --color-brown-light: #5C4A3D;
  }
  * { box-sizing: border-box; }
  body {
    font-family: 'Outfit', system-ui, sans-serif;
    background: var(--color-cream);
    color: var(--color-brown);
  }
  .form-container {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
  }
  .form-card {
    background: #fff;
    border-radius: 1.5rem;
    padding: 2.5rem;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 460px;
  }
  .form-card h1 {
    font-family: 'Cormorant Garamond', Georgia, serif;
    font-size: 2rem;
    margin-bottom: .5rem;
  }
  .form-description {
    margin-bottom: 1.5rem;
    color: var(--color-brown-light);
  }
  .form-group { margin-bottom: 1rem; }
  .form-group label { display: block; margin-bottom: .5rem; font-weight: 500; }
  .form-group input {
    width: 100%;
    padding: .75rem 1rem;
    border: 1px solid #ddd;
    border-radius: .75rem;
  }
  .password-input-wrap {
    position: relative;
  }
  .password-input-wrap input {
    padding-right: 3rem;
  }
  .password-toggle {
    position: absolute;
    right: .75rem;
    top: 50%;
    transform: translateY(-50%);
    width: 2rem;
    height: 2rem;
    border-radius: 999px;
    border: 1px solid #e7ddd1;
    background: linear-gradient(135deg, #fff, #f7efe5);
    cursor: pointer;
    color: var(--color-terracotta);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
  }
  .password-toggle:hover {
    transform: translateY(-50%) scale(1.05);
    border-color: #d4b598;
    box-shadow: 0 6px 14px rgba(196, 112, 75, 0.2);
  }
  .password-toggle svg {
    width: 1rem;
    height: 1rem;
  }
  .btn {
    width: 100%;
    border: none;
    border-radius: 999px;
    background: var(--color-terracotta);
    color: #fff;
    padding: .75rem 1.5rem;
    cursor: pointer;
  }
  .btn:hover { background: var(--color-terracotta-dark); }
  .flash {
    padding: .9rem 1rem;
    border-radius: .75rem;
    margin-bottom: 1rem;
  }
  .flash.error { background: #fee2e2; color: #991b1b; }
  .flash.success { background: #d1fae5; color: #065f46; }
  .form-footer {
    text-align: center;
    margin-top: 1rem;
    font-size: .95rem;
  }
  .form-footer a { color: var(--color-terracotta); text-decoration: none; font-weight: 500; }
</style>

<div class="form-container">
  <div class="form-card">
    <h1>Nouveau mot de passe</h1>
    <p class="form-description">Choisissez un nouveau mot de passe securise.</p>

    {% for label, messages in app.flashes %}
      {% for message in messages %}
        <div class="flash {{ label }}">{{ message }}</div>
      {% endfor %}
    {% endfor %}

    <form method="post" action="{{ path('app_reset_password', {'token': token}) }}">
      <input type="hidden" name="_csrf_token" value="{{ csrf_token('reset_password') }}">
      <div class="form-group">
        <label for="password">Nouveau mot de passe</label>
        <div class="password-input-wrap">
          <input id="password" name="password" type="password" required>
          <button type="button" class="password-toggle" data-target="password" aria-label="Afficher le mot de passe">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path class="eye-shape" d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6-10-6-10-6Z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="1.8"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="form-group">
        <label for="password_confirm">Confirmer le mot de passe</label>
        <div class="password-input-wrap">
          <input id="password_confirm" name="password_confirm" type="password" required>
          <button type="button" class="password-toggle" data-target="password_confirm" aria-label="Afficher le mot de passe">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path class="eye-shape" d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6-10-6-10-6Z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="1.8"/>
            </svg>
          </button>
        </div>
      </div>
      <button class="btn" type="submit">Mettre a jour</button>
    </form>

    <div class="form-footer">
      <a href="{{ path('app_login') }}">Retour a la connexion</a>
    </div>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    var toggles = document.querySelectorAll('.password-toggle');
    toggles.forEach(function (btn) {
      btn.addEventListener('click', function () {
        var targetId = btn.getAttribute('data-target');
        var input = document.getElementById(targetId);
        if (!input) return;
        var show = input.type === 'password';
        input.type = show ? 'text' : 'password';
        btn.setAttribute('aria-label', show ? 'Masquer le mot de passe' : 'Afficher le mot de passe');
        var eyeShape = btn.querySelector('.eye-shape');
        if (eyeShape) {
          eyeShape.setAttribute('d', show
            ? 'M3 3l18 18M2 12s3.5-6 10-6c2.2 0 4.1.7 5.7 1.7M22 12s-3.5 6-10 6c-2.2 0-4.1-.7-5.7-1.7'
            : 'M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6-10-6-10-6Z');
        }
      });
    });
  });
</script>
{% endblock %}
